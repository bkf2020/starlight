<!doctype html>
{% load static %}
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<title>&#x1F320; Starlight: {{ problem.name }}</title>
		<link rel="stylesheet" type="text/css" href="{% static 'css/main.css' %}" />
	</head>
    <body>
		<div style="display: flex; justify-content: space-between; align-items: center;">
			<div>
				<h1>&#x1F320; {{ problem.name }}</h1>
			</div>
			<div style="float: right;">
				{% if user.is_authenticated %}
					<a href="{% url 'profile' %}">{{ user.username }}</a> |
					<a href="{% url 'logout' %}">Logout</a>
				{% else %}
					<a href="{% url 'login' %}?next={{ request.path }}">Login</a> |
					<a href="{% url 'register' %}">Register</a>
				{% endif %}
			</div>
		</div>
		<p>View the summary of the hints to this problem as well as the key insights/observations. Filter out problems with similar key insights/observations.</p>
        <p>
			<a href="{{ problem.link }}" target="_blank" rel="noopener noreferrer">Link to problem</a> |
			<a href="{% url 'view-all-summary' %}?problem={{ problem.id }}&type=hint">Summary of hints</a> |
			<a href="{% url 'view-all-summary' %}?problem={{ problem.id }}&type=insight">Summary of insights and similar problems</a>
		</p>
		{% if request.GET.type == "hint" %}
			<h2 id="submit">Submit a new hint</h2>
			{% if user.is_authenticated %}
				{% if user_hints %}
					<h3 id="userHints">Your Hints</h3>
					<ol>
					{% for hint in user_hints %}
						<li><div class="hintInsightContainer">
							<p style="margin-top: 0.5em; margin-bottom: 0.5em;">{{ hint.text }}</p>
							<a class="buttonLink bg-blue" href="{% url 'hint-update' hint.id %}">Edit</a><a class="buttonLink bg-red" href="{% url 'hint-delete' hint.id %}">Delete</a>
						</div></li>
					{% endfor %}
					</ol>
				{% else %}
					<p id="userHints">You currently don't have any hints.</p>
				{% endif %}
				<form method="POST">
					{% csrf_token %}
					{{ hint_form }}
					<button type="submit" class="bg-green">Submit hints</button>
				</form>
			{% else %}
				<div class="alert alert-error">Please login before submitting new hints/insights.</div>
			{% endif %}
		{% else %}
			<h2 id="submit">Submit a new insight</h2>
			{% if user.is_authenticated %}
				{% if user_insights %}
					<h3 id="userInsights">Your Insights</h3>
					<ol>
					{% for insight in user_insights %}
						<li><div class="hintInsightContainer">
							<p style="margin-top: 0.5em; margin-bottom: 0.5em;">{{ insight.text }}</p>
							<a class="buttonLink bg-blue" href="{% url 'insight-update' insight.id %}">Update</a><a class="buttonLink bg-red" href="{% url 'insight-delete' insight.id %}">Delete</a>
						</div></li>
					{% endfor %}
					</ol>
				{% else %}
					<p id="userInsights">You currently don't have any insights/observations.</p>
				{% endif %}
				<form method="POST">
					{% csrf_token %}
					{{ insight_form }}
					<button type="submit" class="bg-green">Submit insights</button>
				</form>
			{% else %}
				<div class="alert alert-error">Please login before submitting new hints/insights.</div>
			{% endif %}
		{% endif %}
    </body>
</html>